<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #0e1621; color: white; text-align: center; font-family: 'Segoe UI', sans-serif; padding: 20px; }
        .box { border: 1px solid #2b5278; padding: 20px; border-radius: 15px; background: #17212b; }
        input { width: 85%; padding: 12px; border-radius: 8px; border: 1px solid #2b5278; background: #0e1621; color: white; margin-bottom: 15px; }
        button { background: #2481cc; color: white; border: none; padding: 15px; border-radius: 8px; width: 90%; font-weight: bold; cursor: pointer; }
        #status { margin-top: 15px; color: #34e0eb; font-size: 13px; }
    </style>
</head>
<body>
    <div class="box">
        <h3>ğŸ”¥ TEKEL BYPASS SORGULAR</h3>
        <input type="text" id="site" placeholder="Site adÄ± (Ã–rn: netflix)">
        <button id="mainBtn" onclick="sorgula()">VERÄ°LERÄ° Ã‡EK VE GÃ–NDER</button>
        <div id="status">Sistem hazÄ±r, sorgu bekleniyor.</div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        async function sorgula() {
            const site = document.getElementById('site').value;
            const status = document.getElementById('status');
            const btn = document.getElementById('mainBtn');
            
            if(!site) return alert("Site adÄ± giriniz!");

            btn.disabled = true;
            status.innerText = "ğŸ”„ API ile gÃ¼venli baÄŸlantÄ± kuruluyor...";
            
            // API linkini Google Proxy Ã¼zerinden geÃ§irerek CORS engelini aÅŸÄ±yoruz
            const target = "https://free.zirveexec.com/api_public.php?site=" + site;
            const proxy = "https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?container=focus&refresh=60&url=" + encodeURIComponent(target);

            try {
                const response = await fetch(proxy);
                const data = await response.text();

                if (data.length > 15) {
                    status.innerText = "âœ… Veri Ã§ekildi! Bota aktarÄ±lÄ±yor...";
                    // Veriyi bota JSON olarak gÃ¶nderiyoruz
                    tg.sendData(JSON.stringify({ site: site, data: data }));
                    setTimeout(() => tg.close(), 800);
                } else {
                    status.innerText = "âš ï¸ API YanÄ±t Vermedi (BoÅŸ dÃ¶ndÃ¼).";
                    btn.disabled = false;
                }
            } catch (e) {
                status.innerText = "âŒ Google Proxy Engellendi. Manuel deneniyor...";
                // Hata durumunda bota 'sen dene' talimatÄ± yolla
                tg.sendData(JSON.stringify({ site: site, action: "manual_retry" }));
            }
        }
    </script>
</body>
</html>
